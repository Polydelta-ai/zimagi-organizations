<p align="center">
  <img width="460" height="150" src="assets/zimagi-logo.png">
</p>
<hr/>

<h1 align="center"><b>Organization</b> <i>Data Module</i></h1>
<br/>

## Overview
<hr/>
<br/>

This module provides a foundation for building organization based data models within the Zimagi platform.

<br/>

## Components
<hr/>
<br/>

### Roles
<br/>

| _Name_ | _Description_ |
| ---- | ----------- |
| **organization-admin** | _Administrative privileges over organization data_ |
<br/>

### Data Models
<br/>

| _Name_ | _Description_ |
| ---- | ----------- |
| **organization** | _Basic organization model meant to be extended_ |
<br/>

### Orchestration Profiles
<br/>

| _Name_ | _Description_ |
| ---- | ----------- |
| **build** | _Builds data centric Zimagi specifications_ |
<br/>

## How to Use
<hr/>
<br/>

_From the Linux command line interface:_

```bash
# Install the Zimagi application and remote client

pip install zimagi

# Initialize Zimagi platform and make any configuration updates

zimagi env get
#
# The first time executed the zimagi command will provide a link
# to the autogenerated configuration file for the user.  Make any
# changes to this file and run the zimagi command again to continue
# initializing the platform
#

# Install this module into the Zimagi platform

zimagi module add \
    https://github.com/Polydelta-ai/zimagi-organizations.git \
    reference=main

# Work with the Zimagi organization data models
# (also available through the Command API)

zimagi organization list --help
zimagi organization get --help
zimagi organization save --help
zimagi organization remove --help
zimagi organization clear --help

# Access organization data through the Data API

# List or search organizations
curl https://localhost:5323/organization
# Get JSON list of specific fields for searchable organizations
curl https://localhost:5323/organization/json
# Get a CSV export of specific fields for searchable organizations
curl https://localhost:5323/organization/csv
# Get a total count of searchable organizations with field name (non NULL)
curl https://localhost:5323/organization/count/{field_name}
# Get a list of unique field values for searchable organizations (non NULL)
curl https://localhost:5323/organization/values/{field_name}
```

_From a Python script:_

```bash
# First ensure zimagi is added to environment or requirements.txt
zimagi>=0.8.0
```

```python
# Import the zimagi package
import zimagi

# Create a message handler for streaming Command API messages
# (if you need or want)
def message_callback(message):
    message.display()

# Create API gateway (using default/development settings)
api = zimagi.Client(
    user = "admin",
    token = "uy5c8xiahf93j2pl8s00e6nb32h87dn3",
    encryption_key = "RFJwNYpqA4zihE8jVkivppZfGVDPnzcq",
    host = "localhost",
    command_port = 5123,
    data_port = 5323,
    message_callback = message_callback
)

# Add Zimagi module
api.extend('https://github.com/Polydelta-ai/zimagi-organizations.git', 'main',
    provider = 'git'
)

# Execute any Zimagi command
#
# Can reference commands using:
#
# * space separated strings "user list" (CLI format)
# * slash separated strings "user/list" (API format)
# * dot separated strings   "user.list"
#
response = api.execute('organization.list')

#
# Organization SDK interface
#

# Save organizations
api.save('organization', None, # key is autogenerated
    name = "Testing LTD"
    city = "Washington"
    state = "DC",
    zipcode = 20024
)

# List and search access organizations (hyperlinked related objects)
results = api.list('organization', name__icontains = "federal")

# Return field collections in various formats
json_results = api.json('organization', fields = ['name', 'city', 'state'])
df = api.dataframe('organization', fields = ['name', 'zipcode'])

# Access organization data
data = api.get('organization', "{key}")

# Get organization field information
results = api.values('organization', 'name')
count = api.count('organization', 'name')

# Remove organizations
api.remove('organization', "{key}")
api.clear('organization')
```